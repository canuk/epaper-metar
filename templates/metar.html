<!DOCTYPE html>
<html>
<head>
  <title>METAR E-Paper Selector</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="/static/favicon.ico">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>

<!-- This Style is specific to the help text that appears when a selection is made -->
<!-- Technique taken from https://tutorialdeep.com/knowhow/change-image-on-dropdown-select-option-jquery/ -->
<style>
.myDiv{
	display:none;
    text-align:center;
}  
.myDiv img{
  margin: 0 auto;
}
.myDiv span{
	text-align: center;
    background: #ffffff;
    background-color: transparent;
    padding: 2px 2px;
    display: block;
    width: 120px;
    border: 0px solid blue;
    margin: 2px auto;
	font-family: Arial, Helvetica, sans-serif;
}
</style>
 <p>
 
<!-- This script is used to 'show' the appropriate <div> for the specific information about a selection -->
<script>
$(document).ready(function(){
    $('#myselection').on('change', function(){
    	var demovalue = $(this).val(); 
		demovalue=$.trim(demovalue.replace(/\s/g, ''));
        $("div.myDiv").hide();
        $("#show"+demovalue).show();
		console.log(demovalue);
    });
});
</script>

<script>
$(document).ready(function(){
   $(window).bind("load", function() {
        $("div.myDiv").hide();
        $("#show"+"0").show();
		console.log(demovalue);
  });
});
</script>

 
<!-- Main HTML code to display dropdown and submit button -->
<div class="container-fluid">
  <div class="card border-primary mb-3">
  <section class="py-5">

<div class="container">
<form action="{{ url_for('metar') }}" method="post"> 

		<table class="table table-bordered">
		  <tbody>
            <tr class="table-warning">
              <td width="50%">
                <h2>METAR E-Paper Display Admin Page</h2>
                <label for="display"><b>Choose a Function:</b></label><br>
                <select name="display" id="display">
                  <option value="metar" {% if display=="metar" %} selected="selected" {% endif %}>Display METAR Info</option>
                  <option value="off" {% if display=="off" %} selected="selected" {% endif %}>Clear E-Paper Display</option>
                  <option value="reboot" {% if display=="reboot" %} selected="selected" {% endif %}>Reboot RPi</option>
                  <option value="powerdown" {% if display=="powerdown" %} selected="selected" {% endif %}>Power Down RPi</option>
                </select>
		      </td>
		      <td>
		    <div id="show0" class="myDiv">
                 <span><p>
                   <img src="./static/layout0.jpg" width="120"><p><p>
                   </span>
                   </div>
            <div id="show1" class="myDiv">
                 <span><p>
                   <img src="./static/layout1.jpg" width="120"><p><p>
                   </span>
                   </div>
            <div id="show2" class="myDiv">
                 <span><p>
                   <img src="./static/layout2.jpg" width="120"><p><p>
                   </span>
                   </div>
            <div id="show3" class="myDiv">
                 <span><p>
                   <img src="./static/layout3.jpg" width="120"><p><p>
                   </span>
                   </div>
            <div id="show4" class="myDiv">
                 <span><p>
                   <img src="./static/layout4.jpg" width="120"><p><p>
                   </span>
                   </div>
            <div id="show5" class="myDiv">
                 <span><p>
                   <img src="./static/layout5.jpg" width="120"><p><p>
                   </span>
                   </div>
            <div id="show6" class="myDiv">
                 <span><p>
                  <img src="./static/layout6.jpg" width="120"><p><p>
                  </span>
                  </div>
            <div id="show7" class="myDiv">
                 <span><p>
                  <img src="./static/layout7.jpg" width="120"><p><p>
                  </span>
                  </div>
            <div id="show8" class="myDiv">
                 <span><p>
                  <img src="./static/layout8.jpg" width="120"><p><p>
                  </span>
                  </div>
            <div id="show9" class="myDiv">
                 <span><p>
                  <img src="./static/layout9.jpg" width="120"><p><p>
                  </span>
                  </div>
	         </td>
            </tr>
          </tbody>
        </table>
					
					
					
      <!-- Select display parameters -->
      <div class="form-group">
		<table class="table table-bordered">
		  <tbody>
            <tr class="table-primary">
              <td width="50%">
                <label for="fname"><b>Enter 4 Character ICAO Airport ID:</b></label><br>
                <input style="text-transform: uppercase;" name="data_field1" id="data_field1" placeholder="KFLG" type="text" maxlength="4" minlength="4" size="4" list="list1" onfocus="this.value=''" value="{{ data_field1 }}" onchange="myFunction(this)" value="{{ data_field1 }}">									
                <br>
                <a href="https://www.world-airport-codes.com/" target="_blank">https://www.world-airport-codes.com/</a> to lookup ICAO ID's
              </td> 
              
            <!--  <td width="30%"
              <div name='apinfo'>&nbsp</div>
              </td> -->
              
              <td width="50%">
                <label for="fname"><b>Choose Layout:</b></label><br>
                <select name="data_field2" id="myselection">
                  <option value="-2" {% if data_field2=="-2" %} selected="selected" {% endif %}>Cycle Through All Layouts</option>
                  <option value="-1" {% if data_field2=="-1" %} selected="selected" {% endif %}>Display Random Layouts</option>
                  <option value="0" {% if data_field2=="0" %} selected="selected" {% endif %}>Large Flight Category and METAR</option>
                  <option value="1" {% if data_field2=="1" %} selected="selected" {% endif %}>METAR with Data Display</option>
                  <option value="2" {% if data_field2=="2" %} selected="selected" {% endif %}>Data Display with Icons</option>
                  <option value="3" {% if data_field2=="3" %} selected="selected" {% endif %}>Basic Large Flight Category</option>
                  <option value="4" {% if data_field2=="4" %} selected="selected" {% endif %}>3 Area Display with METAR</option>
                  <option value="5" {% if data_field2=="5" %} selected="selected" {% endif %}>Multiple Airport Flight Categories</option>
                  <option value="6" {% if data_field2=="6" %} selected="selected" {% endif %}>Airport Map and Flight Category</option>
                  <option value="7" {% if data_field2=="7" %} selected="selected" {% endif %}>Flight Category In Circles</option>
                  <option value="8" {% if data_field2=="8" %} selected="selected" {% endif %}>Worst Class B & C Airport Weather</option>
                  <option value="9" {% if data_field2=="9" %} selected="selected" {% endif %}>Metar and Large Wind Icons</option>
                </select>
                <br>
                <b>Note:</b> There are options to randomly display or cyle through all layouts.
              </td>
            </tr>
            <tr class="table-primary">
              <td width="50%">
                <label for="fname"><b>Display Airport Info or Remarks Key:</b></label><br>
                <select name="data_field4" id="data_field4"> 
                  <option value="0" {% if data_field4=="0" %} selected="selected" {% endif %}>Display Airport Info</option>
                  <option value="1" {% if data_field4=="1" %} selected="selected" {% endif %}>Display Remarks Key</option>
                </select>
                <br>
                <b>Note:</b> Airport Info provides basic info about the station.<br>
                Remarks will decode info from the Remarks field of METAR
              </td>
              <td width="50%">
                <label for="fname"><b>Choose Update Interval:</b></label><br>
                <select name="data_field3" id="data_field3">
                  <option value="0" {% if data_field3=="0" %} selected="selected" {% endif %}>Auto Interval</option>
                  <option value="60" {% if data_field3=="60" %} selected="selected" {% endif %}>1 Minute</option>
                  <option value="120" {% if data_field3=="120" %} selected="selected" {% endif %}>2 Minutes</option>
                  <option value="300" {% if data_field3=="300" %} selected="selected" {% endif %}>5 Minutes</option>
                  <option value="600" {% if data_field3=="600" %} selected="selected" {% endif %}>10 Minutes</option>
                  <option value="900" {% if data_field3=="900" %} selected="selected" {% endif %}>15 Minutes</option>
                  <option value="1200" {% if data_field3=="1200" %} selected="selected" {% endif %}>20 Minutes</option>
                  <option value="1800" {% if data_field3=="1800" %} selected="selected" {% endif %}>30 Minutes</option>
                  <option value="3600" {% if data_field3=="3600" %} selected="selected" {% endif %}>1 Hour</option>
                  <option value="7200" {% if data_field3=="7200" %} selected="selected" {% endif %}>2 Hours</option>

                </select>
                <br>
                <i><b>Note:</b> Auto Interval changes the update based on Flight Category.<br> 
                VFR=1 hour, MVFR=30 mins, IFR=20 mins and LIFR=10 mins</i>
		      </td>
            </tr>
          </tbody>
        </table>
		
		
		<!-- Setup dropdowns to select Units to display -->

		<table class="table table-bordered">
		  <tbody>
            <tr class="table-success">
              <td width="50%">
                <label for="fname"><b>Windspeed Units:</b></label><br>
                <select name="data_field5" id="data_field5"> 
                  <option value="0" {% if data_field5=="0" %} selected="selected" {% endif %}>km/h - Kilometers/Hour</option>
                  <option value="1" {% if data_field5=="1" %} selected="selected" {% endif %}>m/s - Meters/Second</option>
                  <option value="2" {% if data_field5=="2" %} selected="selected" {% endif %}>kts - Knots</option>
                  <option value="3" {% if data_field5=="3" %} selected="selected" {% endif %}>mph - Miles/Hour</option>
                </select>
              </td>
              <td width="50%">
                <label for="fname"><b>Cloud Layers Units:</b></label><br>
                <select name="data_field6" id="data_field6"> 
                  <option value="0" {% if data_field6=="0" %} selected="selected" {% endif %}>Feet</option>
                  <option value="1" {% if data_field6=="1" %} selected="selected" {% endif %}>Meters</option>
                </select>
              </td>
            </tr>
            <tr class="table-success">
              <td width="50%">
                <label for="fname"><b>Visibility Units:</b></label><br>
                <select name="data_field7" id="data_field7"> 
                  <option value="0" {% if data_field7=="0" %} selected="selected" {% endif %}>Miles</option>
                  <option value="1" {% if data_field7=="1" %} selected="selected" {% endif %}>Kilometers</option>
                </select>
              </td>
              <td width="50%">                
                <label for="fname"><b>Temperature Units:</b></label><br>
                <select name="data_field8" id="data_field8"> 
                  <option value="0" {% if data_field8=="0" %} selected="selected" {% endif %}>Celsius</option>
                  <option value="1" {% if data_field8=="1" %} selected="selected" {% endif %}>Farhenheit</option>
                </select>
              </td>
            </tr>
            <tr class="table-success">
              <td colspan="2">
                <label for="fname"><b>Pressure Units:</b></label><br>
                <select name="data_field9" id="data_field9"> 
                  <option value="0" {% if data_field9=="0" %} selected="selected" {% endif %}>Hectopascal</option>
                  <option value="1" {% if data_field9=="1" %} selected="selected" {% endif %}>Inch/Hg</option>
                </select>
              </td>
            </tr>
          </tbody>
        </table>
        </div>


		<table class="table table-bordered">
		  <tbody>
            <tr class="table-danger">
             <td width="50%">
            <label for="fname"><b>Select Preferred Layouts to Display:</b></label><br> 
            <b>Note</b>: Select the layouts desired to be displayed.<p> 
            Works only with '<i>Cycle Through All Layouts</i>' function above.<p>
            The function '<i>Display Random Layouts</i>' will randomly select from all Layouts.<p>
            Leave all checkboxes blank if all Layouts are to be used (or select all of them).<p>
           </td>
             <td width="50%">
            <input type="checkbox" value="0" class="danger" name='data_field10' {% if "0" in data_field10 %} checked {% endif %}> Large Flight Category and METAR<br>
            <input type="checkbox" value="1" class="danger" name='data_field10' {% if "1" in data_field10 %} checked {% endif %}> METAR with Data Display<br>
            <input type="checkbox" value="2" class="danger" name='data_field10' {% if "2" in data_field10 %} checked {% endif %}> Data Display with Icons<br>
            <input type="checkbox" value="3" class="danger" name='data_field10' {% if "3" in data_field10 %} checked {% endif %}> Basic Large Flight Category<br>            
            <input type="checkbox" value="4" class="danger" name='data_field10' {% if "4" in data_field10 %} checked {% endif %}> 3 Area Display with METAR<br>
            <input type="checkbox" value="5" class="danger" name='data_field10' {% if "5" in data_field10 %} checked {% endif %}> Multiple Airport Flight Categories<br>
            <input type="checkbox" value="6" class="danger" name='data_field10' {% if "6" in data_field10 %} checked {% endif %}> Airport Map and Flight Category<br>
            <input type="checkbox" value="7" class="danger" name='data_field10' {% if "7" in data_field10 %} checked {% endif %}> Flight Category In Circles<br>
            <input type="checkbox" value="8" class="danger" name='data_field10' {% if "8" in data_field10 %} checked {% endif %}> Worst Class B & C Airport Weather<br>
            <input type="checkbox" value="9" class="danger" name='data_field10' {% if "9" in data_field10 %} checked {% endif %}> Metar and Large Wind Icons<br>        
              </td>
            </tr>
          </tbody>
        </table>


		<table class="table table-bordered">
		  <tbody>
            <tr class="table-secondary">
              <td width="50%">
                <button class="btn btn-primary" type="submit">Submit</button>
                </form>
              </td>
              <td>
                <!-- Flash message via flask and jinja to announce what is currently being displayed -->
                <div class="flashes">
                {% with messages = get_flashed_messages() %}
                  {% if messages %}
                    <div class=flashes>
                    {% for message in messages %}
                      </div><b class="text-danger">{{ message }}</b>
                    {% endfor %}
                  {% endif %}
	            {% endwith %}
	            </div>
              </td>
            </tr>
          </tbody>
        </table>

<!--	<hr>

	<div id="show0" class="myDiv">
     <span><p>
	       <img src="./static/layout0.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show1" class="myDiv">
     <span><p>
	       <img src="./static/layout1.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show2" class="myDiv">
     <span><p>
	       <img src="./static/layout2.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show3" class="myDiv">
     <span><p>
	       <img src="./static/layout3.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show4" class="myDiv">
     <span><p>
	       <img src="./static/layout4.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show5" class="myDiv">
     <span><p>
	       <img src="./static/layout5.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show6" class="myDiv">
     <span><p>
	       <img src="./static/layout6.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show7" class="myDiv">
     <span><p>
	       <img src="./static/layout7.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show8" class="myDiv">
     <span><p>
	       <img src="./static/layout8.jpg" width="300"><p><p>
		   </span>
	 </div>
	<div id="show9" class="myDiv">
     <span><p>
	       <img src="./static/layout9.jpg" width="300"><p><p>
		   </span>
	 </div>
-->

</div>
</div>	
<center><i>Copyright 2024, 2025 - Mark Harris, <a href=https://github.com/markyharris/metar>https://github.com/markyharris/metar</a></i></center>

<script>
function myFunction(selectObject) {
    var x = selectObject.value;

    if (x.length != 4) {
        window.alert("You Must Enter 4 Char Airport ID");
        document.getElementById('data_field1').focus();
        return;
    }
    
    document.getElementById('apinfo').innerHTML = "<a href=https://nfdc.faa.gov/nfdcApps/services/ajv5/airportDisplay.jsp?airportId="+x+" target="+"_blank"+">You entered: "+x+". Click for more info.</a>";
}
</script>

</body>
</html>
